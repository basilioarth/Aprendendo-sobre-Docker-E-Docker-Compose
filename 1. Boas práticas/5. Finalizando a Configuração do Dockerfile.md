**Resumo da Aula: Execu칞칚o do Container, Problemas e Boas Pr치ticas com Docker**  

---

### **Objetivo da Aula**  
Executar a aplica칞칚o Node.js em um container Docker, identificar problemas comuns e introduzir boas pr치ticas como o uso de `.dockerignore` para otimizar o processo de build.  

---

### **Principais Passos**  
1. **Build da Imagem Docker**:  
   - Comando usado:  
     ```bash  
     docker build -t widget-server:v1 .  
     ```  
   - Resultado: Imagem criada com mais de **1GB** (proposital para ilustrar problemas de tamanho).  

2. **Execu칞칚o do Container**:  
   - Comando para rodar em modo detached (em segundo plano):  
     ```bash  
     docker run -d -p 3000:3333 widget-server:v1  
     ```  
   - Verifica칞칚o com `docker ps`: Lista containers em execu칞칚o.  

3. **Identifica칞칚o de Problemas**:  
   - **Container para de funcionar**: Ao acessar `localhost:3000`, o container 칠 encerrado porque o `.env` n칚o foi copiado (devido ao `.dockerignore`).  
   - **Logs do container**:  
     ```bash  
     docker logs <container_id>  
     ```  
     Revela erro `ENOENT: .env not found`.  

4. **Introdu칞칚o ao `.dockerignore`**:  
   - Arquivo criado para ignorar arquivos desnecess치rios durante o build:  
     ```text  
     node_modules  
     .env  
     dist  
     Dockerfile  
     ```  
   - **Objetivo**:  
     - Evitar c칩pia de arquivos irrelevantes (ex: `node_modules`, `.env`).  
     - Reduzir o tamanho da imagem e evitar exposi칞칚o de dados sens칤veis.  

---

### **Problemas Identificados**  
1. **Tamanho da Imagem**:  
   - A imagem ultrapassa **1GB** devido  base `node:20-bookworm` e falta de otimiza칞칚o.  
   - **Solu칞칚o futura**: Uso de imagens leves (ex: `node:20-alpine`) e *multi-stage builds*.  

2. **Vari치veis de Ambiente**:  
   - O `.env` foi ignorado pelo `.dockerignore`, causando falha na execu칞칚o.  
   - **Solu칞칚o futura**: Gerenciar vari치veis via `docker run --env-file` ou servi칞os de secrets (ex: AWS Secrets Manager).  

3. **Build em Modo Dev**:  
   - O comando `pnpm run dev` n칚o 칠 ideal para produ칞칚o (sem transpila칞칚o do TypeScript).  
   - **Solu칞칚o futura**: Separar etapas de build e runtime com *multi-stage builds*.  

---

### **Boas Pr치ticas Introduzidas**  
| **Pr치tica**               | **Benef칤cio**                                      |  
|---------------------------|---------------------------------------------------|  
| `.dockerignore`            | Reduz tamanho da imagem e evita vazamento de dados sens칤veis. |  
| Uso de `WORKDIR`           | Organiza o diret칩rio de trabalho dentro do container.          |  
| Exposi칞칚o de portas (`EXPOSE`) | Documenta a porta necess치ria para acesso externo.           |  

---

### **Pr칩ximos Passos (Spoiler)**  
- **Otimiza칞칚o de Imagem**:  
  - Uso de `node:20-alpine` e *multi-stage builds* para reduzir tamanho.  
- **Vari치veis de Ambiente Seguras**:  
  - Integra칞칚o com `docker-compose` ou servi칞os de cloud (ex: AWS Parameter Store).  
- **Build de Produ칞칚o**:  
  - Transpilar TypeScript para JavaScript antes de executar o container.  

---

**游 Conclus칚o**  
A aula destacou a import칙ncia de:  
- Gerenciar arquivos ignorados com `.dockerignore`.  
- Monitorar logs para debug r치pido.  
- Planejar etapas de build para ambientes de produ칞칚o.  

游녤 **Dica do Instrutor**:  
*"Um container eficiente 칠 como um sushi: pequeno, enxuto e com apenas o necess치rio para brilhar!"* 游꼮  

**Pr칩xima aula**: Redu칞칚o dr치stica do tamanho da imagem e prepara칞칚o para deploy em produ칞칚o! 游